<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de cartas 7 y medio</title>
    <style>
        body {
            background-image: './cartas/tapete.jpg';
            background-color: #0f6b0f;
        }

        button {
            margin-right: 50px;
        }

        button img {
            height: 200px;
        }
    </style>
</head>

<body>

    <button onclick="resetearPagina()">Resetear Página</button>
    <img id="medalla" alt="Imagen medalla"><br />
    <button onclick="obtenerValorCarta()"><img src="./cartas/trasera_jug.jpg"></button>
    <button id="terminar" onclick="plantarse()"><img src="./cartas/trasera.jpg"></button>
    <script>

        /*
        Se quiere jugar al juego de cartas 7 y medio. EL jugador saca una carta y decide si quieres arriesgarse a sacar otra carta o prefiere plantae. Si el jugador se planta comiennza el turno de la banca, que esta obligada a sacar  una puntuacion mayor o igual que la del jugador.El jugador gana si no sobrepasa 7,5 y la banca se pasa. 
        Se quiere usar las cartas de 1 al 7 y las figuras, del 1 al 7 valen 1 punto y las figuras (8, 9, 10) son 0.5 ( las imagenes estan en un zip)
        Las funciones son:
        -obtener las cartas de forma aleatorio y una vez que se obtenga esa carta no vuelva a aparecer en esa jugada
        -el usuario podra elegir una nueva carta haciendo doble click en el boton de cartas restantes o haciendo click al plantarse, la banca jugara siempre hasta superar al usuario o hasta pasarse de 7.5 con las cartas restantes
        -se debe llevar un contador de ambos
        -se debe ir añadiendo en su respectiva lista (mediante el dom) las cartas que se han sacado tanto del jugador como de la banca
        -si el usuario pulsa la letra f, la pagina se recargara
        -se debe notificar quien gana
        -se debe añadir la medalla al ganador
        -crea una cookie que registra si ha ganado el jugador o si ha ganado la banca  y que expire en 5 min
        */

        let mazo = [
            { carta: "1 de Copas", valor: 1 },
            { carta: "2 de Copas", valor: 2 },
            { carta: "3 de Copas", valor: 3 },
            { carta: "4 de Copas", valor: 4 },
            { carta: "5 de Copas", valor: 5 },
            { carta: "6 de Copas", valor: 6 },
            { carta: "7 de Copas", valor: 7 },
            { carta: "8 de Copas", valor: 0.5 },
            { carta: "9 de Copas", valor: 0.5 },
            { carta: "10 de Copas", valor: 0.5 },
            { carta: "1 de Bastos", valor: 1 },
            { carta: "2 de Bastos", valor: 2 },
            { carta: "3 de Bastos", valor: 3 },
            { carta: "4 de Bastos", valor: 4 },
            { carta: "5 de Bastos", valor: 5 },
            { carta: "6 de Bastos", valor: 6 },
            { carta: "7 de Bastos", valor: 7 },
            { carta: "8 de Bastos", valor: 0.5 },
            { carta: "9 de Bastos", valor: 0.5 },
            { carta: "10 de Bastos", valor: 0.5 },
            { carta: "1 de Oros", valor: 1 },
            { carta: "2 de Oros", valor: 2 },
            { carta: "3 de Oros", valor: 3 },
            { carta: "4 de Oros", valor: 4 },
            { carta: "5 de Oros", valor: 5 },
            { carta: "6 de Oros", valor: 6 },
            { carta: "7 de Oros", valor: 7 },
            { carta: "8 de Oros", valor: 0.5 },
            { carta: "9 de Oros", valor: 0.5 },
            { carta: "10 de Oros", valor: 0.5 },
            { carta: "1 de Espadas", valor: 1 },
            { carta: "2 de Espadas", valor: 2 },
            { carta: "3 de Espadas", valor: 3 },
            { carta: "4 de Espadas", valor: 4 },
            { carta: "5 de Espadas", valor: 5 },
            { carta: "6 de Espadas", valor: 6 },
            { carta: "7 de Espadas", valor: 7 },
            { carta: "8 de Espadas", valor: 0.5 },
            { carta: "9 de Espadas", valor: 0.5 },
            { carta: "10 de Espadas", valor: 0.5 },
        ];

        // Función para barajar el mazo
        function barajar(mazo) {
            for (let i = mazo.length - 1; i > 0; i--) {
                let j = Math.floor(Math.random() * (i + 1));
                [mazo[i], mazo[j]] = [mazo[j], mazo[i]];
            }
            return mazo;
        }

        // Función para obtener el valor de una carta
        function obtenerValorCarta(carta) {
            return carta.valor;
        }

        // Función para jugar una ronda
        function jugarRonda() {
            let carta = mazo.pop();
            return carta;
        }

        // Función para sumar el valor de las cartas en la mano
        function sumarMano(mano) {
            let suma = 0;
            for (let i = 0; i < mano.length; i++) {
                suma += mano[i].valor;
            }
            return suma;
        }

        // Función para determinar si se ha sobrepasado 7 y medio
        function sobrepasoSieteYMedio(puntaje) {
            return puntaje > 7.5;
        }

        //funcion para sabber el puntuaje del jugador


        // Juego
        barajar(mazo);
        let manoJugador = [jugarRonda(), jugarRonda()]; // El jugador toma dos cartas
        console.log("Tus cartas son:");
        console.log(manoJugador);

        let continuar = true;

        while (continuar) {
            let respuesta = prompt("¿Quieres otra carta o prefieres plantarte? (s = seguir/n = plantarse)");
            if (respuesta.toLowerCase() === "s") {
                let nuevaCarta = jugarRonda();
                manoJugador.push(nuevaCarta);
                console.log("Tu nueva carta es:");
                console.log(nuevaCarta);
                let puntaje = sumarMano(manoJugador);
                console.log("Tu puntaje actual es:", puntaje);
                if (sobrepasoSieteYMedio(puntaje)) {
                    console.log("¡Has perdido! Te pasaste de 7 y medio.");
                    continuar = false;
                }
            } else {
                continuar = false;
            }
        }


        //Si el usuario pulsa la tecla f, lapaginna debe recargarse
        function resetearPagina() {
            location.reload();
        }


        document.addEventListener('keypress', (event) => {
            console.log(event.key);
            if (event.key === 'f') {
                return;
            }
            resetearPagina();
        });


        //Medalla del jugador ganador
        function medalla() {
            let image = document.getElementById('medalla');
            image.setAttribute('src', srcPath);
        }

        document.addEventListener('keypress', (event) => {
            console.log(event.key);
            if (puntaje > 7.5) {
                return
            }
            medalla(`./cartas/medalla.jpg`);
        });

        //funcion para plantarse
        function plantarse() {
            let acabar = document.getElementById('terminar');
            acabar.addEventListener('click', () => {
                alert('EL jugador se ha plantado...');
            })
        }

    </script>
</body>

</html>